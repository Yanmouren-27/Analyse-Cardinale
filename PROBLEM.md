# 枫丹审判庭：芙宁娜与「谕示裁定枢机」的可撤销证词一致性最大化挑战

## 题目背景
在枫丹，审判常在 **歌剧院（Opera Epiclese）** 举行，芙宁娜会以极高热情参与每一场审判，并非常在意“观众”的反应。审判过程中，作为终审裁定装置的 **谕示裁定枢机（Oratrice Mecanique d'Analyse Cardinale）** 会在听取控辩双方的陈述后给出裁决。  

在一场场公开审理中，证词与证据会不断追加、撤回或被推翻：某位证人可能改口，某份证据可能被判定无效，新的线索也可能迫使旧结论被重新审视。为了让审判流程不被“自相矛盾的证词网”拖垮，你需要维护一个系统：支持证词约束的动态加入/撤销，并在任意时刻评估——在当前证词集合中，最多能保留多少条证词，使它们彼此自洽。

---

## 问题描述

你维护 $N$ 个命题（事实条目），编号为 $1..N$。每条证词是一条二元逻辑约束：

- `S a b`：表示 $a \oplus b = 0$（同真同假）
- `D a b`：表示 $a \oplus b = 1$（一真一假）

其中 $\oplus$ 为异或。所有命题的真值未知（你无需输出真值）。

系统顺序处理 $Q$ 个操作，操作分三类：

### 1) 追加证词

```
A id type a b
```

将编号为 `id` 的证词加入当前集合：

- `type = S` 表示 $a \oplus b = 0$
- `type = D` 表示 $a \oplus b = 1$

保证同一个 `id` 在加入前未处于“已加入未撤销”的状态。

### 2) 撤销证词

```
R id
```

撤销编号为 `id` 的证词。保证该 `id` 当前处于“已加入未撤销”的状态。

### 3) 询问一致性最大化

```
Q
```

在当前证词集合 $E$ 中，你可以选择一个子集 $E'\subseteq E$，要求 $E'$ 中所有约束可同时满足。你需要输出你找到的 $|E'|$ 的最大化结果的一个近似值（越大越好）。

评测器会验证你输出的 $E'$ 是否自洽，并据此计分。

---

## 输入格式
```
N Q
op1
op2
...
opQ
```

---

## 输出要求（关键）

### 审计查询（Q / C）

评测器在评测时会 **多次运行** 你的程序。每次运行会用固定种子随机把输入中的一部分 `Q` 改写为 `C`（Checked Query，用于抽查）。

- 对于输入中的 `Q`：你只需要输出一行 **一个整数** `K`（你的声明/claim）。

- 对于输入中的 `C`：你需要输出一行证词子集作为见证（witness）：

  ```
  K id1 id2 ... idK
  ```

  评测器会验证该子集在当前未撤销证词中且 **可同时满足**。

一致性要求（非常重要）：

- 同一个数据会被运行多次；对于同一个查询位置，你输出的 `K` 必须在所有运行中完全一致，否则该数据点记 0 分。
- 任何一次 `C` 查询的见证集合不合法或存在矛盾，该数据点记 0 分。

对每个 `Q` 操作输出一行：

```
K id1 id2 ... idK
```

其中：

- $K$ 是你选择保留的证词条数（允许 $K=0$）
- $id_1..id_K$ 是你选择保留的证词编号（互不相同，且必须是当前未撤销的证词）

评测器将仅对你输出的这些证词检查是否可满足：

- 若可满足，则本次查询的有效值为 $K$
- 若不可满足或输出非法，则本次查询有效值为 $0$
---

## 评分方式（基线为 100 分）

对每次 `Q` 查询，记：

- 当前未撤销证词数量为 $m$
- 基线输出的可行保留数量为 $k_0$
- 你的输出在通过校验后得到的可行保留数量为 $k$（若输出非法或不自洽，则 $k=0$）

当 $m=0$ 时：若你输出 $k=0$，该次得分为 $200$；否则为 $0$。

当 $m>0$ 时：

- 若 $k\le k_0$，该次得分为 $100\times\frac{k}{\max(1,k_0)}$
- 若 $k>k_0$，定义

$$
z=\frac{k-k_0}{m-k_0}\in(0,1]
$$

该次得分为
$$
score_q = 100 + 100\times z^2
$$

若 $k_0=m$ 且 $k\le m$，本次得分为
$$
score_q = 100\times\frac{k}{\max(1,k_0)}
$$

每次得分截断到 $[0,200]$。最终成绩为所有查询得分的平均值，再对所有测试取平均（保留 7 位小数）。


## 数据规模与约束

- $1 \le N \le 10^5$
- $1 \le Q \le 10^5$
- $1 \le a,b \le N$
- `id` 为正整数，且任意时刻同一 `id` 最多对应一条“已加入未撤销”的证词

---

## 评测约束

- 输出必须可解析，且每个 `Q` 对应一行输出
- 任何越界/重复/引用已撤销证词的输出视为非法，该次查询有效值为 0
